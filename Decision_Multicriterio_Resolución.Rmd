---
title: "Decisión Multicriterio: Compra de un ordenador portátil"
author: "Alicia Casaux Vazquez"
date: "Curso 2024/25"
output:
  pdf_document:
    toc: true
    toc_depth: 5
  html_document:
    toc: true
lang: es
---

```{r setup, include=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo=FALSE, include=FALSE, warning=FALSE}
source("teoriadecision_funciones_multicriterio_diagram.R")
source("teoriadecision_funciones_multicriterio_utiles.R")
source("teoriadecision_funciones_multicriterio.R")
```

\newpage

# ENUNCIADO 1 

Un usuario está considerando comprar un nuevo ordenador portátil para mejorar la productividad en su trabajo, se encuentra entre cinco diferentes modelos (*Dell XPS*, *HP Spectre*, *Lenovo ThinkPad*, *MacBook Air* y *Asus ZenBook*). Para elegir el mejor modelo se va estudiar una serie de criterios: **precio**, **rendimiento**, **duración de batería**, **peso/portabilidad**, **pantalla, durabilidad** y **conectividad/compatibilidad**.

  -   **Matriz de Criterios**

```{r, echo=FALSE}
n.criterios <- c("Precio", "Rendimiento", "Duración de batería", "Peso/Portabilidad", "Pantalla", "Durabilidad", "Conectividad/Compatibilidad")
tabcriterios <- multicriterio.crea.matrizvaloraciones_mej(c(5,7,1/3,3,9,1/5,
                                                            1/3,5,1/9,7,3,
                                                            1/7,3,1/3,9,
                                                            3,1/9,1/5,
                                                            9,1/7,
                                                            1/9), 
                                                          numalternativas = 7, v.nombres.alternativas = n.criterios)

tabcriterios %>%
  kable(booktabs = TRUE,digits = 2) %>%
  kable_styling(latex_options = c("striped", "condensed","HOLD_position", "scale_down"), 
                position = "center",
                full_width = FALSE)
```

  -   **Matrices Alternativas/Criterios**
  

```{r, echo=FALSE}
n.alternativas = c("Dell XPS", "HP Spectre", "Lenovo ThinkPad", "MacBook Air", "Asus ZenBook")
```
  
  -   *Precio*

```{r, echo=FALSE}
tabprecio <- multicriterio.crea.matrizvaloraciones_mej(c(3,1/3,5,1/5,
                                                         1/7,1/9,1/3,
                                                         5,9,
                                                         1/7), 
                                                          numalternativas = 5, v.nombres.alternativas = n.alternativas)

tabprecio%>%
  kable(booktabs = TRUE,digits = 2) %>%
  kable_styling(latex_options = c("striped", "condensed","HOLD_position"), 
                position = "center",
                full_width = FALSE)
``` 
  
  -   *Rendimiento*
```{r, echo=FALSE}
tabrendimiento <- multicriterio.crea.matrizvaloraciones_mej(c(1/5,7,1/3,9,
                                                              1/9,1/7,5,
                                                              1/5,1/3,
                                                              3), 
                                                          numalternativas = 5, v.nombres.alternativas = n.alternativas)

tabrendimiento%>%
  kable(booktabs = TRUE,digits = 2) %>%
  kable_styling(latex_options = c("striped", "condensed","HOLD_position"), 
                position = "center",
                full_width = FALSE)
``` 
  
  -   *Duración de batería*
```{r, echo=FALSE}
tabbateria <- multicriterio.crea.matrizvaloraciones_mej(c(1/3,5,1/7,3,
                                                          1/7,9,1/7,
                                                          3,5,
                                                          7), 
                                                          numalternativas = 5, v.nombres.alternativas = n.alternativas)

tabbateria%>%
  kable(booktabs = TRUE,digits = 2) %>%
  kable_styling(latex_options = c("striped", "condensed","HOLD_position"), 
                position = "center",
                full_width = FALSE)
``` 
  
\newpage

  -   *Peso/Portabilidad*
```{r, echo=FALSE}
tabpeso <- multicriterio.crea.matrizvaloraciones_mej(c(9,5,1/3,1/7,
                                                       1/5,1/3,5,
                                                       1/7,1/9,
                                                       7), 
                                                          numalternativas = 5, v.nombres.alternativas = n.alternativas)

tabpeso%>%
  kable(booktabs = TRUE, digits = 2) %>%
  kable_styling(latex_options = c("striped", "condensed","HOLD_position"), 
                position = "center",
                full_width = FALSE)
``` 
  
  -   *Pantalla*
```{r, echo=FALSE}
tabpantalla <- multicriterio.crea.matrizvaloraciones_mej(c(3,1/7,1/9,5,
                                                           1/3,3,5,
                                                           3,1/5,
                                                           1/3), 
                                                          numalternativas = 5, v.nombres.alternativas = n.alternativas)

tabpantalla%>%
  kable(booktabs = TRUE, digits = 2) %>%
  kable_styling(latex_options = c("striped", "condensed","HOLD_position"), 
                position = "center",
                full_width = FALSE)
``` 
  
  -   *Durabilidad*
```{r, echo=FALSE}
tabdurabilidad <- multicriterio.crea.matrizvaloraciones_mej(c(7,1/3,9,1/5,
                                                              7,1/5,5,
                                                              3,1/3,
                                                              3), 
                                                          numalternativas = 5, v.nombres.alternativas = n.alternativas)

tabdurabilidad%>%
  kable(booktabs = TRUE, digits = 2) %>%
  kable_styling(latex_options = c("striped", "condensed","HOLD_position"), 
                position = "center",
                full_width = FALSE)
``` 
  
  -   *Conectividad/Compatibilidad*
```{r, echo=FALSE}
tabconect <- multicriterio.crea.matrizvaloraciones_mej(c(1/3,5,1/7,5,
                                                         1/9,1/3,7,
                                                         3,1/5,
                                                         9), 
                                                          numalternativas = 5, v.nombres.alternativas = n.alternativas)

tabconect%>%
  kable(booktabs = TRUE, digits = 2) %>%
  kable_styling(latex_options = c("striped", "condensed","HOLD_position"), 
                position = "center",
                full_width = FALSE)
``` 

\newpage

# RESOLUCIÓN

## Funciones de clase

### Método 1 (mayor autovalor)

**Cálculo pesos locales**

*Método mayor autovalor*

```{r}
pes_criterios <- multicriterio.metodoAHP.variante1.autovectormayorautovalor(tabcriterios)
pes_precio <- multicriterio.metodoAHP.variante1.autovectormayorautovalor(tabprecio)
pes_rendimiento <- multicriterio.metodoAHP.variante1.autovectormayorautovalor(tabrendimiento)
pes_bateria <- multicriterio.metodoAHP.variante1.autovectormayorautovalor(tabbateria)
pes_peso <- multicriterio.metodoAHP.variante1.autovectormayorautovalor(tabpeso)
pes_pantalla <- multicriterio.metodoAHP.variante1.autovectormayorautovalor(tabpantalla)
pes_durabilidad <- multicriterio.metodoAHP.variante1.autovectormayorautovalor(tabdurabilidad)
pes_conect <- multicriterio.metodoAHP.variante1.autovectormayorautovalor(tabconect)

```

**Cálculo pesos globales**

```{r}
tab01 <- multicriterio.metodoAHP.pesosglobales_entabla(pes_criterios$valoraciones.ahp, 
                                                       rbind(pes_precio$valoraciones.ahp,
                                                             pes_rendimiento$valoraciones.ahp,
                                                             pes_bateria$valoraciones.ahp,
                                                             pes_peso$valoraciones.ahp,
                                                             pes_pantalla$valoraciones.ahp,
                                                             pes_durabilidad$valoraciones.ahp,
                                                             pes_conect$valoraciones.ahp))
```

```{r, echo=FALSE}
tab01 %>%
  kable(booktabs = TRUE) %>%
  kable_styling(latex_options = c("striped", "condensed","HOLD_position", "scale_down"), 
                position = "center",
                full_width = FALSE)
```

En general, la mejor decisión es el **Lenovo ThinkPad** con un peso global del 26,04%

Por criterios;

  -   Para el precio la mejor alternativa es el **Lenovo ThinkPad**
  -   Para el rendimiento la mejor alternativa es el **MacBook Air**
  -   Para la duración de la batería la mejor alternativa es el **Lenovo ThinkPad**
  -   Para el peso la mejor alternativa es el **MacBook Air**
  -   Para la pantalla la mejor alternativa es el **Lenovo ThinkPad**
  -   Para el durabilidad la mejor alternativa es el **Dell XPS**
  -   Para la conectividad la mejor alternativa es el **MacBook Air**
  
Además del método de mayor autovalor, tambien tenemos:

  -   *Método de media geométrica*
```{r}
pes_criterios <- multicriterio.metodoAHP.variante2.mediageometrica(tabcriterios)
pes_precio <- multicriterio.metodoAHP.variante2.mediageometrica(tabprecio)
pes_rendimiento <- multicriterio.metodoAHP.variante2.mediageometrica(tabrendimiento)
pes_bateria <- multicriterio.metodoAHP.variante2.mediageometrica(tabbateria)
pes_peso <- multicriterio.metodoAHP.variante2.mediageometrica(tabpeso)
pes_pantalla <- multicriterio.metodoAHP.variante2.mediageometrica(tabpantalla)
pes_durabilidad <- multicriterio.metodoAHP.variante2.mediageometrica(tabdurabilidad)
pes_conect <- multicriterio.metodoAHP.variante2.mediageometrica(tabconect)
```

  -   *Método básico*
```{r}
pes_criterios <- multicriterio.metodoAHP.variante3.basico(tabcriterios)
pes_precio <- multicriterio.metodoAHP.variante3.basico(tabprecio)
pes_rendimiento <- multicriterio.metodoAHP.variante3.basico(tabrendimiento)
pes_bateria <- multicriterio.metodoAHP.variante3.basico(tabbateria)
pes_peso <- multicriterio.metodoAHP.variante3.basico(tabpeso)
pes_pantalla <- multicriterio.metodoAHP.variante3.basico(tabpantalla)
pes_durabilidad <- multicriterio.metodoAHP.variante3.basico(tabdurabilidad)
pes_conect <- multicriterio.metodoAHP.variante3.basico(tabconect)
```

### Método 2 (completo)
```{r}
num.alt = 5
num.crt = 7
Xarray_nivel2 = array (NA, dim=c(num.alt, num.alt, num.crt))
Xarray_nivel2[,,1] = tabprecio
Xarray_nivel2[,,2] = tabrendimiento
Xarray_nivel2[,,3] = tabbateria
Xarray_nivel2[,,4] = tabpeso
Xarray_nivel2[,,5] = tabpantalla
Xarray_nivel2[,,6] = tabdurabilidad
Xarray_nivel2[,,7] = tabconect
pg_com = multicriterio.metodoAHP.variante3.completo(tabcriterios,Xarray_nivel2)
tab_com <- pg_com$pesos.globales_entabla
```

```{r, echo=FALSE}
tab_com %>%
  kable(booktabs = TRUE) %>%
  kable_styling(latex_options = c("striped", "condensed","HOLD_position", "scale_down"), 
                position = "center",
                full_width = FALSE)
```

## Diagrama Jerarquías
```{r, echo=FALSE}
num.alt <- 5
num.crt <- 7
Xmatriznivel2 <- array(NA, dim = c(num.alt, num.alt, num.crt))
Xmatriznivel2[,,1] <- tabprecio
Xmatriznivel2[,,2] <- tabrendimiento
Xmatriznivel2[,,3] <- tabbateria
Xmatriznivel2[,,4] <- tabpeso
Xmatriznivel2[,,5] <- tabpantalla
Xmatriznivel2[,,6] <- tabdurabilidad
Xmatriznivel2[,,7] <- tabconect
dimnames(Xmatriznivel2)[[1]] <- n.alternativas
multicriterio.metodoahp.diagrama(tabcriterios, Xmatriznivel2)
```

## Método AHP
```{r,echo=FALSE}
library(ahp)
datos = Load("datos.ahp")
Calculate(datos)
```

```{r,echo=FALSE}
Visualize(datos)
```

**Tabla solución (contribución total)**

```{r,echo=FALSE}
export_formattable(AnalyzeTable(datos), file = "tablaahp1.png")
```

**Tabla solución (pesos locales)**

```{r, echo=FALSE}
t2 = AnalyzeTable(datos, variable = "priority")
export_formattable(t2, file = "tablaahp2.png")
```

## Método ELECTRE

## Método PROMETHEE

